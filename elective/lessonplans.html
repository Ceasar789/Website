<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lesson Plans - Teacher LMS</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
<style>
:root{
  --bg-light:#f4f6fc;
  --bg-dark:#121212;
  --card-bg:#fff;
  --card-hover:#e9f0ff;
  --text-dark:#000;
  --text-light:#fff;
}
body{background:var(--bg-light);font-family:'Segoe UI',sans-serif;transition:all .3s;color:var(--text-dark);}
body.dark{background:var(--bg-dark);color:var(--text-light);}
.navbar{box-shadow:0 4px 12px rgba(0,0,0,.08);}
.card-box{
  background:var(--card-bg);
  padding:15px 20px;
  border-radius:12px;
  box-shadow:0 4px 12px rgba(0,0,0,.05);
  margin-bottom:15px;
  transition:all .3s;
}
.card-box:hover{transform:translateY(-2px);box-shadow:0 8px 20px rgba(0,0,0,.1);background:var(--card-hover);}
.lesson-title{cursor:pointer; font-weight:bold; display:flex; justify-content:space-between; align-items:center;}
.lesson-details{display:none; margin-top:10px; transition:all .3s;}
input,textarea{border-radius:8px;}
button{transition:all .2s;}
button:hover{transform:translateY(-1px);}
.counter{font-weight:bold;margin-bottom:10px;}
</style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary px-4">
<a class="navbar-brand" href="index.html">Teacher LMS</a>
<button class="btn btn-outline-light btn-sm ms-auto me-2" onclick="toggleDarkMode()"><i class="bi bi-moon-fill"></i></button>
<button class="btn btn-outline-light btn-sm" onclick="logout()">Logout</button>
</nav>

<!-- Back to Home -->
<div class="container mt-3">
  <button class="btn btn-secondary mb-3" onclick="window.location.href='dashboard.html'"><i class="bi bi-house-door"></i> Back to Home</button>
</div>

<div class="container mt-2">
<h3>Lesson Plan Builder <span class="counter" id="planCount">(0)</span></h3>
<div class="card-box">
<input id="lpTopic" class="form-control mb-2" placeholder="Topic">
<textarea id="lpObj" class="form-control mb-2" placeholder="Objectives"></textarea>
<textarea id="lpIntro" class="form-control mb-2" placeholder="Introduction"></textarea>
<textarea id="lpDiscuss" class="form-control mb-2" placeholder="Discussion"></textarea>
<textarea id="lpAssess" class="form-control mb-2" placeholder="Assessment"></textarea>
<button class="btn btn-success w-100" onclick="addPlan()"><i class="bi bi-save"></i> Save</button>
</div>
<div id="planList"></div>
</div>

<script>
function logout(){if(confirm("Are you sure you want to logout?")) window.location.href="login.html";}
function toggleDarkMode(){document.body.classList.toggle('dark');}

/* Load plans */
let plans = JSON.parse(localStorage.getItem('plans')||'[]');
let planList = document.getElementById('planList');
let planCount = document.getElementById('planCount');

function updateCounter(){ planCount.innerText = `(${plans.length})`; }

function addPlan(){
  if(!lpTopic.value) return alert('Enter topic.');
  plans.push({t:lpTopic.value,o:lpObj.value,i:lpIntro.value,d:lpDiscuss.value,a:lpAssess.value});
  localStorage.setItem('plans',JSON.stringify(plans));
  lpTopic.value=lpObj.value=lpIntro.value=lpDiscuss.value=lpAssess.value='';
  renderPlans();
  addActivity(`Added Lesson Plan: ${plans[plans.length-1].t}`);
}

function renderPlans(){
  planList.innerHTML='';
  plans.forEach((p,i)=>{
    const div = document.createElement('div');
    div.className='card-box';
    div.innerHTML=`
      <div class="lesson-title" onclick="toggleDetails(this)">
        ${p.t} <i class="bi bi-chevron-down"></i>
      </div>
      <div class="lesson-details">
        <p><b>Objectives:</b> ${p.o}</p>
        <p><b>Introduction:</b> ${p.i}</p>
        <p><b>Discussion:</b> ${p.d}</p>
        <p><b>Assessment:</b> ${p.a}</p>
        <button class="btn btn-danger btn-sm mt-2" onclick="deletePlan(${i})">Delete</button>
      </div>
    `;
    planList.appendChild(div);
  });
  updateCounter();
}

function toggleDetails(el){
  const details = el.nextElementSibling;
  const icon = el.querySelector('i');
  if(details.style.display==='block'){
    details.style.display='none';
    icon.classList.replace('bi-chevron-up','bi-chevron-down');
  } else {
    details.style.display='block';
    icon.classList.replace('bi-chevron-down','bi-chevron-up');
  }
}

function deletePlan(i){
  addActivity(`Deleted Lesson Plan: ${plans[i].t}`);
  plans.splice(i,1);
  localStorage.setItem('plans',JSON.stringify(plans));
  renderPlans();
}

/* Activity log */
function addActivity(text){
  let recentActivities = JSON.parse(localStorage.getItem('recentActivities')||'[]');
  recentActivities.push(text);
  localStorage.setItem('recentActivities',JSON.stringify(recentActivities));
}

renderPlans();
</script>

</body>
</html>
